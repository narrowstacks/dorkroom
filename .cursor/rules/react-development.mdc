---
globs: *.tsx,*.jsx
description: React component development standards and patterns
---

# React Development

React 19 with TanStack Router v1 (file-based routing). Use Context7 for TanStack library patterns.

## File-Based Routing

Routes in `apps/dorkroom/src/routes/`:

```typescript
// routes/border.tsx
import { createFileRoute } from '@tanstack/react-router';

export const Route = createFileRoute('/border')({
  component: BorderCalculatorPage,
});

function BorderCalculatorPage() {
  return <div>Border Calculator</div>;
}
```

## Component Patterns

### Props Interface Naming

```typescript
interface CalculatorCardProps {
  title: string;
  children: ReactNode;
  onReset?: () => void;
}

export const CalculatorCard: FC<CalculatorCardProps> = ({ title, children, onReset }) => {
  // ...
};
```

### Component Structure

```typescript
import { type FC, useState, useEffect } from 'react';
import { cn } from '@dorkroom/ui';
import { useCalculation } from '@dorkroom/logic';

interface MyComponentProps {
  // props
}

export const MyComponent: FC<MyComponentProps> = (props) => {
  // 1. Hooks
  const [state, setState] = useState();
  const calculation = useCalculation();

  // 2. Effects
  useEffect(() => {}, []);

  // 3. Handlers
  const handleClick = () => {};

  // 4. Early returns
  if (calculation.loading) return <div>Loading...</div>;

  // 5. Render
  return <div className={cn('base-class', props.className)}>{/* content */}</div>;
};
```

## TanStack Query

```typescript
const { data, isLoading } = useQuery({
  queryKey: ['recipes', recipeId],
  queryFn: () => fetchRecipe(recipeId),
});

// Mutations with optimistic updates (see packages/logic/CLAUDE.md)
const mutation = useMutation({
  mutationFn: updateRecipe,
  onMutate: async (newRecipe) => {
    await queryClient.cancelQueries({ queryKey: ['recipes', newRecipe.id] });
    const previous = queryClient.getQueryData(['recipes', newRecipe.id]);
    queryClient.setQueryData(['recipes', newRecipe.id], newRecipe);
    return { previous };
  },
  onError: (err, newRecipe, context) => {
    queryClient.setQueryData(['recipes', newRecipe.id], context?.previous);
  },
  onSettled: () => {
    queryClient.invalidateQueries({ queryKey: ['recipes'] });
  },
});
```

## TanStack Form + Zod

```typescript
import { useForm } from '@tanstack/react-form';
import { zodValidator } from '@tanstack/zod-form-adapter';

const form = useForm({
  defaultValues: { paperWidth: 210, paperHeight: 297 },
  validatorAdapter: zodValidator(),
  validators: { onChange: borderSchema },
  onSubmit: async ({ value }) => await calculate(value),
});

// Field usage
<form.Field
  name="paperWidth"
  children={(field) => (
    <NumberInput
      value={field.state.value}
      onChange={(e) => field.handleChange(Number(e.target.value))}
      error={field.state.meta.errors?.[0]}
    />
  )}
/>
```

## Styling with Tailwind

Use `cn()` from `@dorkroom/ui`:

```typescript
import { cn } from '@dorkroom/ui';

const buttonClasses = cn(
  'px-4 py-2 rounded-lg font-medium',
  { 'bg-blue-600 text-white': variant === 'primary' },
  className
);
```

## Accessibility

- Use semantic HTML (`<button>`, `<label>`, `<input>`)
- Include ARIA labels where needed
- Handle keyboard navigation
- Use `:focus-visible` for focus states

## Icons

Use Lucide React with className sizing:

```tsx
import { Camera } from 'lucide-react';

<Camera className="h-5 w-5" />
```
