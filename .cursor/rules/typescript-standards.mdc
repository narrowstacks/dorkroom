---
globs: *.ts,*.tsx
description: TypeScript coding standards and conventions
---

# TypeScript Standards

TypeScript 5.9 with strict mode. Use Context7 for library-specific patterns.

## Critical Rules

### Never Use `any`

```typescript
// ❌ Never
const process = (input: any): any => {};

// ✅ Use specific types
const process = (input: CalculationInput): CalculationResult => {};

// ✅ Use unknown for truly unknown
const parseJSON = (text: string): unknown => JSON.parse(text);

// ✅ Exception: Generic function signatures
type ThrottledFn<T extends (...args: any[]) => any> = (...args: Parameters<T>) => ReturnType<T>;
```

### Type Guards for Narrowing

```typescript
function isCalculationResult(value: unknown): value is CalculationResult {
  return typeof value === 'object' && value !== null && 'borderTop' in value;
}
```

## API Type Conventions

From `@dorkroom/api`:

- `Raw*` types (snake_case from API) → Transformed types (camelCase)
- Use explicit `null` for nullable fields, not optional

```typescript
// ✅ Correct
grainStructure: string | null;

// ❌ Incorrect
grainStructure?: string;
```

## Naming Conventions

| Type | Convention | Example |
|------|------------|---------|
| Types, Interfaces | PascalCase | `BorderCalculationOptions` |
| Variables, Functions | camelCase | `calculateDimensions` |
| Constants | SCREAMING_SNAKE_CASE | `MAX_BORDER_SIZE` |
| Booleans | Prefixed | `isValid`, `hasData`, `canSubmit` |

## Zod Schemas

Always export both schema and inferred type:

```typescript
export const borderInputSchema = z.object({
  paperWidth: z.number().positive(),
  paperHeight: z.number().positive(),
});

export type BorderInput = z.infer<typeof borderInputSchema>;
```

## Type-Only Imports

Separate type imports from value imports:

```typescript
import type { FC, ReactNode } from 'react';
import type { BorderOptions } from '@dorkroom/logic';

import { useState } from 'react';
import { calculateBorderSize } from '@dorkroom/logic';
```

## Utility Types

Use built-in utility types:

```typescript
type PartialOptions = Partial<BorderCalculationOptions>;
type RequiredFields = Required<Pick<Preset, 'name' | 'dimensions'>>;
type OptionKeys = keyof BorderCalculationOptions;
```

## Const Assertions

Use for immutable data:

```typescript
const PAPER_SIZES = {
  A4: { width: 210, height: 297 },
  LETTER: { width: 216, height: 279 },
} as const;

// Use satisfies for type checking without widening
const config = {
  borderWidth: 10,
} satisfies BorderOptions;
```
